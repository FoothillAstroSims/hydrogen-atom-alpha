import React from 'react';
import { scaleLinear } from 'd3/dist/d3';
import PropTypes from 'prop-types';

const WIDTH = 860;
const HEIGHT = 60;

const scale = scaleLinear()
        .domain([0, 15])
        .range([48, WIDTH - 51]);

const renderTickMarks = () => {
    return (data, index) => {
        const lineProperties = {
            x1: data.x,
            x2: data.x,
            y1: data.top,
            y2: data.bottom,
            stroke: "white",
            key: index
        }

        return <line {...lineProperties} />;
    }
}

const renderTickTexts = () => {
    return (data, index) => {
        const textProperties = {
            className: "tickMarkTexts",
            x: data.x - data.shift,
            y: data.top + 15,
            fontSize: `12px`,
            key: index
        }

        return <text {...textProperties}>{data.text}</text>;
    }
}

export default class Spectrum extends React.Component {
    constructor(props) {
        super(props);
    }

    componentDidMount() {

    }

    componentWillUnmount() {

    }

    componentDidUpdate(prevProps, prevState, snapShot) {

    }

    render() {
        const linePosition = scale(this.props.energyValue);
        const shiftLeftValues = [45, 25, 17];
        // The props id sent to us basically indicates whether we are passing frequency, wavelength, or eV so that
        // we can center align the numbers on top of the tick
        const shiftLeft = shiftLeftValues[this.props.id];
        const topY = (HEIGHT / 2) + 5;
        const bottomY = (HEIGHT / 2) - 5;
        // console.log(`linePosition: ${linePosition}`);

        return (
            <svg width={WIDTH} height={HEIGHT}>
                <g>{ this.props.tickMarksData.map( renderTickMarks()) }</g>
                <g>{ this.props.tickMarksData.map( renderTickTexts()) }</g>
                <line x1={linePosition} x2={linePosition} y1={topY} y2={bottomY} stroke={"red"} strokeWidth={2}/>
                <text className={"spectrumTexts"} x={linePosition - shiftLeft} y={16} fontSize={"15px"} >{this.props.value}</text>
            </svg>
        );
    }
}
